%DIZIONARIO E FONT
\usepackage[T1]{fontenc}
\usepackage[utf8x]{inputenc}
\usepackage[italian]{babel}
\usepackage{lmodern}

%TITOLO
\author{\strut}
\date{\strut}
\makeatletter
\renewcommand\maketitle[1][]{
{\raggedright
\begin{center}
\Huge \textit{\textbf{\@title}}\\[1.5ex]
\Large \@author \\[1.5ex]
\large \@date \\[1.5ex]
\end{center}
\ifstrequal{#1}{toc=off}{\bigskip}
{\ifstrequal{#1}{toc=on}{ \vspace*{\fill} \tableofcontents \vspace*{\fill}\thispagestyle{empty}  \newpage}{}} \pagenumbering{arabic}
}}
\makeatother

%GEOMETRIA
\usepackage[left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm, includefoot, headheight=13.6pt]{geometry}

%HYPERLINKS
\usepackage{hyperref}
\hypersetup{hidelinks, linktoc=all}

%LINGUAGGIO MATEMATICO
\usepackage{amssymb, amsmath, latexsym}
\usepackage{physics}
\usepackage{bbold}
\usepackage[makeroom]{cancel}
\renewcommand{\Hat}[1]{\boldsymbol{\hat{\mathbf{#1}}}}
\renewcommand{\vec}{\textbf}
\usepackage[matha]{mathabx}

%GRAFICA
\usepackage{graphicx}
\usepackage{mdframed}
\usepackage{float}

%COMANDI DI STRUTTURA
\usepackage{caption}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{changepage}
\usepackage{etoolbox}
\usepackage{titlesec}
\usepackage{comment}
\usepackage{marginnote}
\usepackage{footnotehyper}
\usepackage[bottom]{footmisc}
\renewcommand*{\marginfont}{\footnotesize\itshape}

%INIDICE E TITOLI
\usepackage{tocloft}
\addto\captionsitalian{\renewcommand{\contentsname}{\LARGE \hspace{-3pt}Contenuti}}
\renewcommand{\cftsubsecfont}{\normalfont}
\renewcommand{\cftsecfont}{\large \bfseries }
\titleclass{\subsubsubsection}{straight}[\subsection]

\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
\renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}} % optional; useful if paragraphs are to be numbered
\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
  {3.25ex \@plus1ex \@minus.2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}%
  {3.25ex \@plus1ex \@minus .2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\def\toclevel@subsubsubsection{4}
\def\toclevel@paragraph{5}
\def\toclevel@paragraph{6}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\makeatother
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}
\titleformat{\section}
{\Huge\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
{\Large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
{\large\bfseries}{\thesubsubsection}{1em}{}

%TEOREMI
\usepackage{amsthm}
\newtheoremstyle{a capo}% nome dello stile
  {\topsep}% spazio sopra
  {\topsep}% spazio sotto
  {\itshape}% font del corpo
  {}% indentazione del primo paragrafo
  {\bfseries}% font dell'intestazione
  {}% punteggiatura dopo l'intestazione
  {\newline}% spazio dopo l'intestazione
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}% formato dell'intestazione
 \newtheoremstyle{due punti}% nome dello stile
  {\topsep}% spazio sopra
  {\topsep}% spazio sotto
  {\itshape}% font del corpo
  {}% indentazione del primo paragrafo
  {\bfseries}% font dell'intestazione
  {:}% punteggiatura dopo l'intestazione
  { }% spazio dopo l'intestazione
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}% formato dell'intestazione
  
\newtheorem{pro}{Proposizione}
\newtheorem{cor}{Corollario}

\theoremstyle{due punti}
\newtheorem{df}{Definizione}
\theoremstyle{a capo}
\newtheorem{teo}{Teorema}
\newtheorem{pr}{Principio}
\newcommand\oss{\noindent \textbf{Osservazione: }}

%CONTATORI
\usepackage{chngcntr}
\usepackage{alphalph}
\renewcommand{\thesubsection}{\arabic{subsection}}
\counterwithin{df}{subsection}
\counterwithin*{pr}{subsection}
\counterwithin{pro}{subsection}
\counterwithin{cor}{subsection}
\counterwithin{teo}{subsection}
\newcounter{es}
\counterwithin*{es}{section}
\newcounter{ese}
\counterwithin*{ese}{subsection}
\counterwithin{equation}{subsection}
\newcounter{aa}
\setcounter{aa}{\the\year}
\addtocounter{aa}{-1}

%DERIVATE E COMANDI MATEMATICI
\newenvironment{pp}[2]{\frac{\partial #1}{\partial #2}}{}
\renewenvironment{dd}[2]{\frac{d #1}{d #2}}{}
\renewcommand{\parallel}{\mathrel{/\mkern-5mu/}}
\makeatletter
\newcommand{\notparallel}{
  \mathrel{\mathpalette\not@parallel\relax}}
\newcommand{\not@parallel}[2]{
  \ooalign{\reflectbox{$\m@th#1\smallsetminus$}\cr\hfil$\m@th#1\parallel$\cr}}
\newcommand{\longmatrix}[4]{\left( \begin{matrix}     #1 & \dots  & #2\\ \vdots & \ddots & \vdots\\ #3 & \dots  & #4 \end{matrix} \right)}
\newcommand{\vettore}[1]{\left( \begin{array}{c} #1 \end{array} \right)}

%AMBIENTI

\newcommand{\theindexsol}{$\R$}
\newcounter{solution}
\setcounter{solution}{0}
\counterwithin{solution}{subsection}
\newenvironment{solution}[1][]{
  \stepcounter{solution} 
  \medskip 
  \noindent\fbox{\textbf{Soluzione~\theindexsol-\thesolution}}\hrulefill\par\vspace{10pt}\noindent\rmfamily%
    \label{sol:\thesolution}%
    \noindent}{
	\medskip
    \par\noindent\hrulefill%
    \fbox{\textbf{Esercizio a pagina: \pageref{es:\thesolution}}}\par\vspace{10pt}% 
}

\newcounter{esercizio}
\setcounter{esercizio}{0}
\counterwithin{esercizio}{subsection}
\newcommand{\theindexese}{$\R$}
\newenvironment{esercizio}[2][]{
  \stepcounter{esercizio} 
  \newcommand{\pagesol}{\pageref{sol:\theesercizio}}
  \medskip 
  \noindent\fbox{\bfseries{Esercizio~\theindexese-\theesercizio~\textit{#1}}}\hrulefill\par\vspace{10pt}\noindent\rmfamily%
    \label{es:\theesercizio}%
    %\addcontentsline{toc}{subsection}{\thesection.\theesercizio~ #1 \hfill  \textit{(Soluzione pag: \pagesol)}}
    \noindent }{ 
	\medskip
    \par\noindent\hrulefill%
    \ifcsname r@sol:\theesercizio\endcsname
      \fbox{\textbf{Soluzione a pagina: \pageref{sol:\theesercizio}}}\par\vspace{10pt}% 
    \else
      \fbox{\textbf{Chi fa da s√©, fa per tre}}\par\vspace{10pt}% 
    \fi
}




%DIMOSTRAZIONE
\newenvironment{dm}[1][] {\medskip \begin{adjustwidth}{1cm}{} \begin{mdframed}[linewidth=1.5,linecolor=gray, topline=false,rightline=false,bottomline=false] \textbf{ Dimostrazione:}{ \itshape #1\ }}{\medskip \hfill{$\square$} \end{mdframed}\end{adjustwidth} \bigskip}
%ESEMPIO
\definecolor{gialloverde}{RGB}{112, 177, 63}
\newenvironment{esempio}[1][] {\medskip \begin{adjustwidth}{1cm}{} \begin{mdframed}[linewidth=1.5,linecolor=gialloverde, topline=false,rightline=false,bottomline=false] \textcolor{gialloverde}{\textbf{Esempio{: #1} \newline}}}{\medskip\end{mdframed}\end{adjustwidth} }

%OSSERVAZIONE
\newlist{osservazioneenum}{enumerate}{1}
\setlist[osservazioneenum]{label=(\textit{\roman*})\hspace{0.5em}, leftmargin=0pt, labelsep=0pt, itemindent=2em}

\newenvironment{osservazioni}[1][]{
  \medskip
  \begin{adjustwidth}{1cm}{}
    \textbf{\textit{Osservazioni:}}\newline
    \vspace{-0.5cm}
    \begin{osservazioneenum}[label=(\textit{\roman*})\hspace{0.5em}, leftmargin=0pt, labelsep=0pt, itemindent=2em]}{
    \end{osservazioneenum}
  \end{adjustwidth}}
  
\newenvironment{osservazione}[1][]{
  \bigskip
  \begin{adjustwidth}{1cm}{}
    \textbf{\textit{Osservazione:}}\vspace{0.1cm} \newline}{
  \everypar{\leftskip=0pt} % Ripristina il rientro del testo
  \end{adjustwidth}}

%IMPAGINAZIONE
\usepackage{fancyhdr}% http://ctan.org/pkg/fancyhdr
\fancypagestyle{thesis}{%
\fancyhf{}
\renewcommand{\headrulewidth}{0.4pt}
\fancyhead[ER]{\textbf{\leftmark}}
\fancyhead[OL]{\textbf{\rightmark}}
\fancyfoot[LO,RE]{\thepage}}

\usepackage{ifthen}
\let\originalsection\section
\renewcommand{\section}[2][]{%
  \ifthenelse{\equal{#1}{}}%
    {\stepcounter{section} \originalsection*{#2}%
     \addcontentsline{toc}{section}{#2}}%
    { %
     \addcontentsline{toc}{section}{#1}}%
       \ifstrempty{#1}
    {\markboth{\MakeUppercase{#2}}{\rightmark}}%
    {\markboth{#1}{\rightmark}}%
}

\let\originalsubsection\subsection
\renewcommand{\subsection}[2][]{%
  \ifstrempty{#1}
    {\originalsubsection{#2}
     \markright{\thesubsection. #2}}%
    {\originalsubsection[#1]{#2}
     \markright{\thesubsection. #1}}%
}

%ADDARI DISLESSICO

\newcommand{\gras}[1]{\textbf{#1}}
\newcommand{\vet}[1]{\vec{#1}}
\newcommand{\ps}[2]{\langle{#1},{#2}\rangle}
\newcommand{\norma}[1]{\| #1 \|}


\newcommand{\duno}[2]{\frac{\partial{#1}}{\partial{#2}}}
\newcommand{\Duno}[2]{\dfrac{\partial{#1}}{\partial{#2}}}
\newcommand{\deuno}[2]{{\partial}_{#2} {#1}}
\newcommand{\dtot}[2]{\dfrac{\mbox{d}{#1}}{\mbox{d}{#2}}}

\newcommand{\ddue}[2]{\frac{\partial^2{#1}}{\partial{{#2}^2}}}
\newcommand{\Ddue}[2]{\dfrac{\partial^2{#1}}{\partial{{#2}^2}}}
\newcommand{\dedue}[2]{{{\partial}^2}_{#2} {#1}}
\newcommand{\ddtot}[2]{\dfrac{\mbox{d}^2 {#1}}{\mbox{d}{#2}^2}}




\newcommand{\soprau}[1]{\stackrel{\mathclap{\normalfont\mbox{#1}}}{=}}
\newcommand{\spazio}{\hspace{0.25em}}
\newcommand{\pippo}{\hspace{0.5em}}
\newcommand{\SP}{\mbox{ }}
\newcommand{\modulo}[1]{\left| {#1} \right|}
\newcommand{\quadre}[1]{\left[ {#1} \right]}
\newcommand{\graffe}[1]{\lbrace {#1} \rbrace}
\newcommand{\tonde}[1]{\left({#1}\right)}
\newcommand{\uncini}[1]{\langle #1 \rangle}
\newcommand{\wt}[1]{\widetilde{#1}}
\newcommand{\wh}[1]{\widehat{#1}}



%ALFABETO MATEMATICO
\newcommand{\A}{\mathcal{A}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\Cc}{\mathbb{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\G}{\mathcal{G}}
\renewcommand{\H}{\mathcal{H}}
\newcommand{\I}{\mathcal{I}}
\renewcommand{\L}{\mathcal{L}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\N}{\mathcal{N}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\P}{\mathcal{P}}
\newcommand{\Q}{\mathcal{Q}}
\newcommand{\R}{\mathcal{R}}
\newcommand{\Rr}{\mathbb{R}}
\renewcommand{\S}{\mathcal{S}}
\newcommand{\T}{\mathcal{T}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\V}{\mathcal{V}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}
\newcommand{\Z}{\mathcal{Z}}
\newcommand{\1}{\mathbb{1}}